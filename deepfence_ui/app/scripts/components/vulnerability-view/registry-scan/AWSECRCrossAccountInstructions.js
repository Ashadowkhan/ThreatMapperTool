import React, { useState } from 'react';

import { REGION_OPTIONS } from '../../../constants/dropdown-option-collection';
import DFSearchableSelectField from '../../common/multi-select/app-searchable-field';

export const AWSECRCrossAccountInstructions = ({
  accountData: data,
  accountDataError: error
}) => {
  const [expanded, setExpanded] = useState(false);
  const [region, setRegion] = useState(REGION_OPTIONS.options[0]);

  return (
    <div>
      <div
        style={{
          cursor: 'pointer',
          marginBottom: 10,
          display: 'flex',
          alignItems: 'center',
        }}
      >
        <div
          style={{
            display: 'flex',
            alignItems: 'center',
            fontSize: 16,
            fontWeight: 'bold',
          }}
          onClick={() => setExpanded(!expanded)}
        >
          {expanded ? (
            <i className="fa fa-chevron-down" />
          ) : (
            <i className="fa fa-chevron-right" />
          )}
          &nbsp;&nbsp; <span>Cross-Account Setup</span>
          &nbsp;&nbsp;
        </div>
        <a
          href="https://community.deepfence.io/threatstryker/docs/operations/registry-scanning/"
          style={{
            fontSize: 14,
            fontWeight: 'normal',
          }}
          target="_blank"
          rel="noreferrer"
        >
          Know More
        </a>
      </div>
      {expanded ? (
        <>
          <div
            className="duration-container df-select-field"
            style={{
              marginBottom: 10,
            }}
          >
            <DFSearchableSelectField
              options={REGION_OPTIONS.options}
              value={region}
              onChange={region => setRegion(region)}
            />
          </div>
          {!error ? (
            <div style={{ marginBottom: 10, marginTop: 10 }}>
              <div
                style={{
                  margin: '10px 0',
                  fontSize: 14,
                }}
              >
                <a
                  href={`https://${region.value}.console.aws.amazon.com/cloudformation/home?region=${region.value}#/stacks/create/review?templateURL=https://deepfence-public.s3.amazonaws.com/cross-account-ecr/deepfence-ecr-role-setup.template&stackName=Deepfence-ECR-Role-Setup&param_AccountId=${data.accountId}`}
                  target="_blank"
                  rel="noreferrer"
                >
                  Setup ECR Registry Account
                </a>
              </div>
              <a
                href={`https://${region.value}.console.aws.amazon.com/cloudformation/home?region=${region.value}#/stacks/create/review?templateURL=https://deepfence-public.s3.amazonaws.com/cross-account-ecr/deepfence-console-account-setup.template&stackName=Deepfence-Mgmt-Console-ECR-Setup`}
                target="_blank"
                rel="noreferrer"
              >
                Setup Deepfence Console Account
              </a>
            </div>
          ) : (
            <div>
              <span className="error-message">{error}</span>
            </div>
          )}
        </>
      ) : null}
    </div>
  );
};
